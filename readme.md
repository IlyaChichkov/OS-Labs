# Операционные системы | Светофор

__Описание задания:__  
Необходимо разработать прототип встраиваемой системы, как совокупность программного обеспечения и стенда на базе Raspberry Pi4, которая позволяла бы управлять переключением светофора по расписанию (тремя светодиодами), а также считывать цвет с помощью соответствующего сенсора (Color Sensor TCS34725). Результаты распознанных цветов должны выводиться в терминале персонального компьютера, подключенного к встраиваемой системе через ssh-соединение.   

__Общая схема и принципы работы встраиваемой системы:__  
Схема соединений всего используемого оборудования представлена на рисунке ниже:  
![Схема варианта 3](var_03_scheme.png)


__Перечень используемого оборудования:__
* микрокомпьютер Raspberry Pi 4;
* отладочная плата OS с подключенными: светодиодами и кнопками, датчика цвета (Color Sensor TCS34725);
* персональный компьютер c установленным ПО (Putty, WinSCP, Git).

__Требования к работе встраиваемой системы:__  
1. Встраиваемая система должна обеспечивать управление тремя светодиодами в режиме светофора и определение свечения цвета, вывод данной информации за счет выполнения трех основных программ: 1 – программа, управляющая светодиодами и опросом кнопок отладочного стенда, 2 – программа, принимающая сигналы с датчика цвета по I2C интерфейсу, 3 – программа, получающая данные от программ 1 и 2 по одному из способов межпроцессного взаимодействия (именованные и неименованные каналы) и выводящяя результат работы светофора и определенного цвета в терминал персонального компьютера, подключенного к встраиваемой системе через ssh-соединение.
2. Программа-1 должна обеспечивать взаимодействие RPi 4 со светодиодами и кнопками с помощью GPIO, работает в многопоточном режиме и выполняют следующие функции:
* настройка режима работы светофора (времена переключения) по аргументу при старте или через команду по не именованным каналам;
* чтение значений кнопки BUTTON0 для ускорения переключения;
* выдача данных о светящемся светодиоде с временной меткой системы;
* прием команд остановки и старта работы по именованным каналам;
3. Программа-2 должна обеспечивать взаимодействие RPi 4 с датчиком цвета по интерфейсу I2C, работает в многопоточном режиме и выполняют следующие функции:
* запись и чтение значений регистров датчика цвета;
* преобразование данных датчика в значение цвета из трех возможных и их комбинации/отсутствия света;
* отправка сигнала о смене цвета или отсутствии данных с временной меткой системы по именованным каналам.
4. Программа-3 должна обеспечивать взаимодействие с программами-1,-2, стандартным потоком вводом/вывода, работает в многопоточном режиме, а также выполняет следующие функции:
* обмен сообщениям по именованным/не именованным каналам с приложениями-1,-2;
* обмен сообщениями со стандартным потоком ввода/вывода, в том числе прием команд от пользователя (start, stop, change_color).
5. Встраиваемая система должна обеспечивать выдачу результатов работы на консоль в следующем формате:
* «время измерения» (hh:mm:ss) 
* «режим работы светофора - … », 
* «измеренный цвет - …», ("красный", "зеленый", "синий", "нет света", "сочетание цветов").
